<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>1. Basic</title>
    <link rel="stylesheet" type="text/css" href="./css/explain.css" />
    <link rel="stylesheet" type="text/css" href="../dist/tui-grid.css" />
</head>
<body>
<div class="explain">
You can see the tutorial <a href="https://github.com/nhnent/tui.grid/wiki/Getting-Started" target="_blank">here</a>
</div>
<div class="code-html">

<button id="append">append</button>
<button id="remove">remove</button>

<div id="grid"></div>
</div>
</body>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js"></script>
<script type="text/javascript" src="https://uicdn.toast.com/tui.code-snippet/v1.3.0/tui-code-snippet.js"></script>
<script type="text/javascript" src="../dist/tui-grid.js"></script>
<script type="text/javascript" src="./data/tree-dummy.js"></script>
<script type="text/javascript" class="code-js">

var grid = new tui.Grid({
    el: $('#grid'),
    data: gridData,
    rowHeaders: ['rowNum', 'radio'],
    treeColumnOptions: {
        name: 'name',
        useIcon: true,
        useCascadingCheckbox: false
    },
    // virtualScrolling: false,
    // rowHeight: 100,
    // bodyHeight: 200,
    columns: [
        {
            title: 'Name',
            name: 'name',
            width: 200
        },
        {
            title: 'Artist',
            name: 'artist'
        },
        {
            title: 'Type',
            name: 'type'
        },
        {
            title: 'Release',
            name: 'release'
        },
        {
            title: 'Genre',
            name: 'genre'
        }
    ]
});

function appendRows(parentRowKey, isDynamicLoaing) {
    var childrenRowData = [
        {
            id: 502796,
            name: '3333',
            artist: 'test333333',
            release: '2015.05.12',
            type: 'EP',
            typeCode: '2',
            genre: 'Hiphop',
            genreCode: '5',
            grade: '5',
            price: 18000,
            downloadCount: 1000,
            listenCount: 5000,
        },
        {
            id: 502790,
            name: '000000',
            artist: '0000000',
            release: '2015.05.12',
            type: 'EP',
            typeCode: '2',
            genre: 'Hiphop',
            genreCode: '5',
            grade: '5',
            price: 18000,
            downloadCount: 1000,
            listenCount: 5000,
        }
    ];

    grid.appendRow([{
        id: 502795,
        name: '11111111',
        artist: 'test111111',
        release: '2015.05.12',
        type: 'EP',
        typeCode: '2',
        genre: 'Hiphop',
        genreCode: '5',
        grade: '5',
        price: 18000,
        downloadCount: 1000,
        listenCount: 5000,
        _extraData: {
            treeState: 'COLLAPSE'
        },
        _children: isDynamicLoaing ? true : childrenRowData
    },
    {
        id: 502793,
        name: '222222',
        artist: 'test2222222',
        release: '2015.05.12',
        type: 'EP',
        typeCode: '2',
        genre: 'Hiphop',
        genreCode: '5',
        grade: '5',
        price: 18000,
        downloadCount: 1000,
        listenCount: 5000
    },
    {
        id: 502797,
        name: '777',
        artist: 'yyyyyyyy',
        release: '2015.05.12',
        type: 'EP',
        typeCode: '2',
        genre: 'Hiphop',
        genreCode: '5',
        grade: '5',
        price: 18000,
        downloadCount: 1000,
        listenCount: 5000
    }], {
        parentRowKey: parentRowKey
    });
}

function removeRows(rowKeys) {
    _.each(rowKeys, function(rowKey) {
        grid.removeRow(rowKey);
    });
}

$('#append').on('click', function() {
    var parentRowKey = grid.getCheckedRowKeys()[0];

    appendRows(parentRowKey);
});

$('#remove').on('click', function() {
    var rowKeys = grid.getCheckedRowKeys();

    removeRows(rowKeys);
});

grid.on('expanded', function(ev) {
    var parentRowKey = ev.rowKey;
    var descendantRowKeys = ev.descendantRowKeys;

    if (!descendantRowKeys.length) {
        removeRows(descendantRowKeys);
        appendRows(parentRowKey, true);
    }
});

</script>
</html>
